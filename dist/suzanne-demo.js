!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=15)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2);class n{constructor(t=0,e=0,i=0,s=1){this.x=t,this.y=e,this.z=i,this.w=s,this.dims=4}add(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}sub(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}mul(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)}times(t){return new n(this.x*t,this.y*t,this.z*t,this.w*t)}div(t){return new n(this.x/t.x,this.y/t.y,this.z/t.z,this.w/t.w)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}mag(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2)+Math.pow(this.w,2))}normalize(){return this.times(1/this.mag())}reflect(t){return t.times(2*this.dot(t)).sub(this)}addTimes(t,e){return new n(this.x+t.x*e,this.y+t.y*e,this.z+t.z*e,this.w+t.w*e)}equals(t,e=s.EPS){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e&&Math.abs(this.w-t.w)<e}get r(){return this.x}set r(t){this.x=t}get g(){return this.y}set g(t){this.y=t}get b(){return this.z}set b(t){this.z=t}get a(){return this.w}set a(t){this.w=t}}e.Vec4=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.degrees=(t=>57.29577951308232*t%360),e.radians=(t=>.017453292519943295*t%6.283185307179586),e.clamp=((t,e,i)=>Math.max(Math.min(t,i),e)),e.parallelogramArea=function(t,e,i){return(e.x-t.x)*(i.y-t.y)-(i.x-t.x)*(e.y-t.y)},e.interpolableAdd=function(t,e){return"number"==typeof t?t+e:t.add(e)},e.interpolableTimes=function(t,e){return"number"==typeof t?t*e:t.times(e)},e.interpolableMul=function(t,e){return"number"==typeof t?t*e:t.mul(e)},e.interpolableAddTimes=function(t,e,i){return"number"==typeof t?t+e*i:t.addTimes(e,i)},e.fillSequence=function(t,e){t.set(e);const i=t.length;let s=e.length;for(;s<i;)t.copyWithin(s,0,s),s<<=1;return t}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(5);function n(t,e){if("string"!=typeof e)return;const i=t[e];if(i instanceof Function)return i;const n=e.split("");if(e.length>1&&e.length<5){const e=n.map(e=>t[e]);return 1===e.length?e[0]:s.vec(...e)}return i}e.EPS=Math.pow(10,-6),e.swizzle=function(t,e){return void 0!==e?n(t,e):new Proxy(t,{get:n})}},function(t,e,i){"use strict";function s(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),s(i(4)),s(i(17)),s(i(12)),s(i(18)),s(i(10)),s(i(1)),s(i(8)),s(i(19)),s(i(20)),s(i(6)),s(i(7)),s(i(0)),s(i(11)),s(i(5)),s(i(2)),s(i(9)),s(i(13)),s(i(14)),s(i(21))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(10),n=i(1),r=i(0);e.Bitmap=class{constructor(t,e){this._width=t,this._height=e,this._data=new Uint8ClampedArray(this._width*this._height*4)}clear(t=s.colors.black){n.fillSequence(this.data,[255*t.r,255*t.g,255*t.b,255*t.a])}_set(t,e,i){const s=4*(t+e*this._width);this._data[s]=255*i.r,this._data[s+1]=255*i.g,this._data[s+2]=255*i.b,this._data[s+3]=255*i.a}get width(){return this._width}get height(){return this._height}resize(t,e){this._width=t,this._height=e,this._data=new Uint8ClampedArray(this._width*this._height*4)}get data(){return this._data}read(t,e){const i=4*(t+e*this._width);return new r.Vec4(this._data[i]/255,this._data[i+1]/255,this._data[i+2]/255,this._data[i+3]/255)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(6),n=i(7),r=i(0),o=i(11),a=i(8);e.vec2=function(...t){switch(t.length){case 0:return new s.Vec2(0,0);case 1:return"number"==typeof t[0]?new s.Vec2(t[0],t[0]):new s.Vec2(t[0].x,t[0].y);case 2:default:return new s.Vec2(t[0],t[1])}},e.vec3=function(...t){switch(t.length){case 0:return new n.Vec3(0,0,0);case 1:if("number"==typeof t[0])return new n.Vec3(t[0],t[0],t[0]);switch(t[0].dims){case 2:return new r.Vec4(t[0].x,t[0].y,0);case 3:case 4:default:return new n.Vec3(t[0].x,t[0].y,t[0].z)}case 2:return new n.Vec3(t[0],t[1],0);default:return new n.Vec3(t[0],t[1],t[2])}},e.vec4=function(...t){switch(t.length){case 0:return new r.Vec4(0,0,0,0);case 1:if("number"==typeof t[0])return new r.Vec4(t[0],t[0],t[0],t[0]);switch(t[0].dims){case 2:return new r.Vec4(t[0].x,t[0].y,t[0].x,t[0].y);case 3:return new r.Vec4(t[0].x,t[0].y,t[0].z,1);case 4:return new r.Vec4(t[0].x,t[0].y,t[0].x,t[0].y);default:if(t[0]instanceof o.VecN){const[e,i,s,n]=t[0].values;return new r.Vec4(e,i,s,n)}throw new Error(`Unexpected vec4 argument: ${t[0]}`)}case 2:if(t[0]instanceof n.Vec3){const e=t[0];return new r.Vec4(e.x,e.y,e.z,t[1])}{const[e,i]=t;return new r.Vec4(e,i,e,i)}case 3:return new r.Vec4(t[0],t[1],t[2],1);default:return new r.Vec4(t[0],t[1],t[2],t[3])}},e.vecn=((...t)=>new o.VecN(t)),e.vec=function(...t){switch(t.length){case 2:return new s.Vec2(t[0],t[1]);case 3:return new n.Vec3(t[0],t[1],t[2]);case 4:return new r.Vec4(t[0],t[1],t[2],t[3]);default:return new o.VecN(t)}},e.mat4=function(...t){if(0===t.length)return new a.Matrix4;if("number"==typeof t[0]){if(1===t.length)return a.Matrix4.scale(t[0]);if(16===t.length)return new a.Matrix4(new Float32Array(t))}if(t[0]instanceof Float32Array)return new a.Matrix4(t[0]);if(t[0]instanceof r.Vec4&&4===t.length){const[e,i,s,n]=t;return new a.Matrix4(new Float32Array([e.x,e.y,e.z,e.w,i.x,i.y,i.z,i.w,s.x,s.y,s.z,s.w,n.x,n.y,n.z,n.w]))}throw new Error(`Unexpected arguments for mat4: ${t}`)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2);class n{constructor(t=0,e=0){this.x=t,this.y=e,this.dims=2}add(t){return new n(this.x+t.x,this.y+t.y)}sub(t){return new n(this.x-t.x,this.y-t.y)}mul(t){return new n(this.x*t.x,this.y*t.y)}times(t){return new n(this.x*t,this.y*t)}div(t){return new n(this.x/t.x,this.y/t.y)}dot(t){return this.x*t.x+this.y*t.y}mag(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}normalize(){return this.times(1/this.mag())}reflect(t){return t.times(2*this.dot(t)).sub(this)}addTimes(t,e){return new n(this.x+t.x*e,this.y+t.y*e)}equals(t,e=s.EPS){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e}}e.Vec2=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2);class n{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i,this.dims=3}add(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z)}mul(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z)}times(t){return new n(this.x*t,this.y*t,this.z*t)}div(t){return new n(this.x/t.x,this.y/t.y,this.z/t.z)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}mag(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))}normalize(){return this.times(1/this.mag())}reflect(t){return t.times(2*this.dot(t)).sub(this)}addTimes(t,e){return new n(this.x+t.x*e,this.y+t.y*e,this.z+t.z*e)}equals(t,e=s.EPS){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e}get r(){return this.x}set r(t){this.x=t}get g(){return this.y}set g(t){this.y=t}get b(){return this.z}set b(t){this.z=t}}e.Vec3=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0);class n{constructor(t){if(void 0!==t){if(16!==t.length)throw new Error(`Matrix4 constructor requires a Float32Array with 16 elements, got ${t.length}`);this._m=t}else this._m=new Float32Array(16),this.identity()}identity(){return this._m.fill(0),this._m[0]=1,this._m[5]=1,this._m[10]=1,this._m[15]=1,this}fill(t){this._m.fill(t)}mul(t){const e=new n,i=t._m;return e._m[0]=this._m[0]*i[0]+this._m[1]*i[4]+this._m[2]*i[8]+this._m[3]*i[12],e._m[1]=this._m[0]*i[1]+this._m[1]*i[5]+this._m[2]*i[9]+this._m[3]*i[13],e._m[2]=this._m[0]*i[2]+this._m[1]*i[6]+this._m[2]*i[10]+this._m[3]*i[14],e._m[3]=this._m[0]*i[3]+this._m[1]*i[7]+this._m[2]*i[11]+this._m[3]*i[15],e._m[4]=this._m[4]*i[0]+this._m[5]*i[4]+this._m[6]*i[8]+this._m[7]*i[12],e._m[5]=this._m[4]*i[1]+this._m[5]*i[5]+this._m[6]*i[9]+this._m[7]*i[13],e._m[6]=this._m[4]*i[2]+this._m[5]*i[6]+this._m[6]*i[10]+this._m[7]*i[14],e._m[7]=this._m[4]*i[3]+this._m[5]*i[7]+this._m[6]*i[11]+this._m[7]*i[15],e._m[8]=this._m[8]*i[0]+this._m[9]*i[4]+this._m[10]*i[8]+this._m[11]*i[12],e._m[9]=this._m[8]*i[1]+this._m[9]*i[5]+this._m[10]*i[9]+this._m[11]*i[13],e._m[10]=this._m[8]*i[2]+this._m[9]*i[6]+this._m[10]*i[10]+this._m[11]*i[14],e._m[11]=this._m[8]*i[3]+this._m[9]*i[7]+this._m[10]*i[11]+this._m[11]*i[15],e._m[12]=this._m[12]*i[0]+this._m[13]*i[4]+this._m[14]*i[8]+this._m[15]*i[12],e._m[13]=this._m[12]*i[1]+this._m[13]*i[5]+this._m[14]*i[9]+this._m[15]*i[13],e._m[14]=this._m[12]*i[2]+this._m[13]*i[6]+this._m[14]*i[10]+this._m[15]*i[14],e._m[15]=this._m[12]*i[3]+this._m[13]*i[7]+this._m[14]*i[11]+this._m[15]*i[15],e}translate(t){const e=new Float32Array(this._m);return e[3]=this._m[3]+this._m[0]*t.x+this._m[1]*t.y+this._m[2]*t.z,e[7]=this._m[7]+this._m[4]*t.x+this._m[5]*t.y+this._m[6]*t.z,e[11]=this._m[11]+this._m[8]*t.x+this._m[9]*t.y+this._m[10]*t.z,e[15]=this._m[15]+this._m[12]*t.x+this._m[13]*t.y+this._m[14]*t.z,this._m=e,this}rotateX(t){const e=new Float32Array(16),i=Math.cos(t),s=Math.sin(t);return e[0]=this._m[0],e[1]=this._m[1]*i+this._m[2]*s,e[2]=this._m[2]*i-this._m[1]*s,e[3]=this._m[3],e[4]=this._m[4],e[5]=this._m[5]*i+this._m[6]*s,e[6]=this._m[6]*i-this._m[5]*s,e[7]=this._m[7],e[8]=this._m[8],e[9]=this._m[9]*i+this._m[10]*s,e[10]=this._m[10]*i-this._m[9]*s,e[11]=this._m[11],e[12]=this._m[12],e[13]=this._m[13]*i+this._m[14]*s,e[14]=this._m[14]*i-this._m[13]*s,e[15]=this._m[15],this._m=e,this}rotateY(t){const e=new Float32Array(16),i=Math.cos(t),s=Math.sin(t);return e[0]=this._m[0]*i-this._m[2]*s,e[1]=this._m[1],e[2]=this._m[2]*i+this._m[0]*s,e[3]=this._m[3],e[4]=this._m[4]*i-this._m[6]*s,e[5]=this._m[5],e[6]=this._m[6]*i+this._m[4]*s,e[7]=this._m[7],e[8]=this._m[8]*i-this._m[10]*s,e[9]=this._m[9],e[10]=this._m[10]*i+this._m[8]*s,e[11]=this._m[11],e[12]=this._m[12]*i-this._m[14]*s,e[13]=this._m[13],e[14]=this._m[14]*i+this._m[12]*s,e[15]=this._m[15],this._m=e,this}rotateZ(t){const e=new Float32Array(16),i=Math.cos(t),s=Math.sin(t);return e[0]=this._m[0]*i+this._m[1]*s,e[1]=this._m[1]*i-this._m[0]*s,e[2]=this._m[2],e[3]=this._m[3],e[4]=this._m[4]*i+this._m[5]*s,e[5]=this._m[5]*i-this._m[4]*s,e[6]=this._m[6],e[7]=this._m[7],e[8]=this._m[8]*i+this._m[9]*s,e[9]=this._m[9]*i-this._m[8]*s,e[10]=this._m[10],e[11]=this._m[11],e[12]=this._m[12]*i+this._m[13]*s,e[13]=this._m[13]*i-this._m[12]*s,e[14]=this._m[14],e[15]=this._m[15],this._m=e,this}transform(t){const e=t instanceof s.Vec4?t.w:1;return new s.Vec4(this._m[0]*t.x+this._m[1]*t.y+this._m[2]*t.z+this._m[3]*e,this._m[4]*t.x+this._m[5]*t.y+this._m[6]*t.z+this._m[7]*e,this._m[8]*t.x+this._m[9]*t.y+this._m[10]*t.z+this._m[11]*e,this._m[12]*t.x+this._m[13]*t.y+this._m[14]*t.z+this._m[15]*e)}det(){return this._m[1]*this._m[11]*this._m[14]*this._m[4]-this._m[1]*this._m[10]*this._m[15]*this._m[4]-this._m[11]*this._m[13]*this._m[2]*this._m[4]+this._m[10]*this._m[13]*this._m[3]*this._m[4]-this._m[0]*this._m[11]*this._m[14]*this._m[5]+this._m[0]*this._m[10]*this._m[15]*this._m[5]+this._m[11]*this._m[12]*this._m[2]*this._m[5]-this._m[10]*this._m[12]*this._m[3]*this._m[5]-this._m[1]*this._m[11]*this._m[12]*this._m[6]+this._m[0]*this._m[11]*this._m[13]*this._m[6]+this._m[1]*this._m[10]*this._m[12]*this._m[7]-this._m[0]*this._m[10]*this._m[13]*this._m[7]-this._m[15]*this._m[2]*this._m[5]*this._m[8]+this._m[14]*this._m[3]*this._m[5]*this._m[8]+this._m[1]*this._m[15]*this._m[6]*this._m[8]-this._m[13]*this._m[3]*this._m[6]*this._m[8]-this._m[1]*this._m[14]*this._m[7]*this._m[8]+this._m[13]*this._m[2]*this._m[7]*this._m[8]+this._m[15]*this._m[2]*this._m[4]*this._m[9]-this._m[14]*this._m[3]*this._m[4]*this._m[9]-this._m[0]*this._m[15]*this._m[6]*this._m[9]+this._m[12]*this._m[3]*this._m[6]*this._m[9]+this._m[0]*this._m[14]*this._m[7]*this._m[9]-this._m[12]*this._m[2]*this._m[7]*this._m[9]}invert(){const t=this.det(),e=new n;return e._m[0]=(-this._m[11]*this._m[14]*this._m[5]+this._m[10]*this._m[15]*this._m[5]+this._m[11]*this._m[13]*this._m[6]-this._m[10]*this._m[13]*this._m[7]-this._m[15]*this._m[6]*this._m[9]+this._m[14]*this._m[7]*this._m[9])/t,e._m[1]=(this._m[1]*this._m[11]*this._m[14]-this._m[1]*this._m[10]*this._m[15]-this._m[11]*this._m[13]*this._m[2]+this._m[10]*this._m[13]*this._m[3]+this._m[15]*this._m[2]*this._m[9]-this._m[14]*this._m[3]*this._m[9])/t,e._m[2]=(-this._m[15]*this._m[2]*this._m[5]+this._m[14]*this._m[3]*this._m[5]+this._m[1]*this._m[15]*this._m[6]-this._m[13]*this._m[3]*this._m[6]-this._m[1]*this._m[14]*this._m[7]+this._m[13]*this._m[2]*this._m[7])/t,e._m[3]=(this._m[11]*this._m[2]*this._m[5]-this._m[10]*this._m[3]*this._m[5]-this._m[1]*this._m[11]*this._m[6]+this._m[1]*this._m[10]*this._m[7]+this._m[3]*this._m[6]*this._m[9]-this._m[2]*this._m[7]*this._m[9])/t,e._m[4]=(this._m[11]*this._m[14]*this._m[4]-this._m[10]*this._m[15]*this._m[4]-this._m[11]*this._m[12]*this._m[6]+this._m[10]*this._m[12]*this._m[7]+this._m[15]*this._m[6]*this._m[8]-this._m[14]*this._m[7]*this._m[8])/t,e._m[5]=(-this._m[0]*this._m[11]*this._m[14]+this._m[0]*this._m[10]*this._m[15]+this._m[11]*this._m[12]*this._m[2]-this._m[10]*this._m[12]*this._m[3]-this._m[15]*this._m[2]*this._m[8]+this._m[14]*this._m[3]*this._m[8])/t,e._m[6]=(this._m[15]*this._m[2]*this._m[4]-this._m[14]*this._m[3]*this._m[4]-this._m[0]*this._m[15]*this._m[6]+this._m[12]*this._m[3]*this._m[6]+this._m[0]*this._m[14]*this._m[7]-this._m[12]*this._m[2]*this._m[7])/t,e._m[7]=(-this._m[11]*this._m[2]*this._m[4]+this._m[10]*this._m[3]*this._m[4]+this._m[0]*this._m[11]*this._m[6]-this._m[0]*this._m[10]*this._m[7]-this._m[3]*this._m[6]*this._m[8]+this._m[2]*this._m[7]*this._m[8])/t,e._m[8]=(-this._m[11]*this._m[13]*this._m[4]+this._m[11]*this._m[12]*this._m[5]-this._m[15]*this._m[5]*this._m[8]+this._m[13]*this._m[7]*this._m[8]+this._m[15]*this._m[4]*this._m[9]-this._m[12]*this._m[7]*this._m[9])/t,e._m[9]=(-this._m[1]*this._m[11]*this._m[12]+this._m[0]*this._m[11]*this._m[13]+this._m[1]*this._m[15]*this._m[8]-this._m[13]*this._m[3]*this._m[8]-this._m[0]*this._m[15]*this._m[9]+this._m[12]*this._m[3]*this._m[9])/t,e._m[10]=(-this._m[1]*this._m[15]*this._m[4]+this._m[13]*this._m[3]*this._m[4]+this._m[0]*this._m[15]*this._m[5]-this._m[12]*this._m[3]*this._m[5]+this._m[1]*this._m[12]*this._m[7]-this._m[0]*this._m[13]*this._m[7])/t,e._m[11]=(this._m[1]*this._m[11]*this._m[4]-this._m[0]*this._m[11]*this._m[5]+this._m[3]*this._m[5]*this._m[8]-this._m[1]*this._m[7]*this._m[8]-this._m[3]*this._m[4]*this._m[9]+this._m[0]*this._m[7]*this._m[9])/t,e._m[12]=(this._m[10]*this._m[13]*this._m[4]-this._m[10]*this._m[12]*this._m[5]+this._m[14]*this._m[5]*this._m[8]-this._m[13]*this._m[6]*this._m[8]-this._m[14]*this._m[4]*this._m[9]+this._m[12]*this._m[6]*this._m[9])/t,e._m[13]=(this._m[1]*this._m[10]*this._m[12]-this._m[0]*this._m[10]*this._m[13]-this._m[1]*this._m[14]*this._m[8]+this._m[13]*this._m[2]*this._m[8]+this._m[0]*this._m[14]*this._m[9]-this._m[12]*this._m[2]*this._m[9])/t,e._m[14]=(this._m[1]*this._m[14]*this._m[4]-this._m[13]*this._m[2]*this._m[4]-this._m[0]*this._m[14]*this._m[5]+this._m[12]*this._m[2]*this._m[5]-this._m[1]*this._m[12]*this._m[6]+this._m[0]*this._m[13]*this._m[6])/t,e._m[15]=(-this._m[1]*this._m[10]*this._m[4]+this._m[0]*this._m[10]*this._m[5]-this._m[2]*this._m[5]*this._m[8]+this._m[1]*this._m[6]*this._m[8]+this._m[2]*this._m[4]*this._m[9]-this._m[0]*this._m[6]*this._m[9])/t,e}static scale(...t){let e,i,s;1===t.length&&("number"==typeof t[0]?(i=e=t[0],s=e):(e=t[0].x,i=t[0].y,s=t[0].z));const r=new n;return r._m[0]=e,r._m[5]=i,r._m[10]=s,r._m[15]=1,r}static perspective(t,e,i,s){const r=new n,o=Math.tan(t/2),a=i-s;return r._m[0]=1/(o*e),r._m[5]=1/o,r._m[10]=(-i-s)/a,r._m[11]=2*s*i/a,r._m[14]=1,r._m[15]=0,r}static screenSpace(t,e){const i=new n,s=t/2,r=e/2;return i._m[0]=s,i._m[3]=s,i._m[5]=r,i._m[7]=r,i}static translation(t){const e=new n;return e._m[3]=t.x,e._m[7]=t.y,e._m[11]=t.z,e}}e.Matrix4=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1);e.VaryingInterpolator=class{constructor(t,...e){this._varyings=new Map,this._vertices=e,this._VAO=t}stepX(t){return t.current=s.interpolableAdd(t.current,t.x_step)}get varyings(){return this._varyings}get VAO(){return this._VAO}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0);function n(t){return new s.Vec4((t>>16&255)/255,(t>>8&255)/255,(255&t)/255,1)}e.hexToColor=n,e.colors={transparent:new s.Vec4(0,0,0,0),black:n(0),white:n(16777215),red:n(16711680),green:n(65280),blue:n(255),yellow:n(16776960),cyan:n(65535),pink:n(16711935),orange:n(16747520),rand:()=>n(Math.floor(16777216*Math.random())),css:void 0},"undefined"!=typeof window&&(e.colors.css=function(t=100){const e=document.createElement("canvas");e.width=1,e.height=1;const i=e.getContext("2d"),n=new Map;return e=>{if(n.has(e))return n.get(e);i.fillStyle=e,i.fillRect(0,0,1,1),i.fill();const[r,o,a,h]=i.getImageData(0,0,1,1).data,_=new s.Vec4(r/255,o/255,a/255,h/255);return n.size===t&&n.delete(n.keys().next().value),n.set(e,_),_}}())},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2);class n{constructor(t){if(t.length<4)throw new Error(`Cannot construct a VecN with less than 4 elements, got : ${t}`);this._values=t instanceof Float32Array?t:new Float32Array(t),this._dims=t.length}add(t){const e=new n(this._values);for(let i=0;i<this._dims;i++)e._values[i]+=t._values[i];return e}sub(t){const e=new n(this._values);for(let i=0;i<this._dims;i++)e._values[i]-=t._values[i];return e}mul(t){const e=new n(this._values);for(let i=0;i<this._dims;i++)e._values[i]*=t._values[i];return e}times(t){const e=new n(this._values);for(let i=0;i<this._dims;i++)e._values[i]*=t;return e}div(t){const e=new n(this._values);for(let i=0;i<this._dims;i++)e._values[i]/=t._values[i];return e}dot(t){let e=0;for(let i=0;i<this._dims;i++)e+=this._values[i]*t._values[i];return e}mag(){let t=0;for(let e=0;e<this._dims;e++)t+=Math.pow(this._values[e],2);return Math.sqrt(t)}normalize(){return this.times(1/this.mag())}reflect(t){return t.times(2*this.dot(t)).sub(this)}addTimes(t,e){const i=new n(this._values);for(let s=0;s<this._dims;s++)i._values[s]=i._values[s]+t._values[s]*e;return i}equals(t,e=s.EPS){if(this._dims!==t._dims)return!1;for(let i=0;i<this._dims;i++)if(Math.abs(this._values[i]-t._values[i])>e)return!1;return!0}get dims(){return this._dims}get values(){return this._values}set values(t){this._values=t,this._dims=t.length}get r(){return this._values[0]}get x(){return this._values[0]}set r(t){this._values[0]=t}set x(t){this._values[0]=t}get g(){return this._values[1]}get y(){return this._values[1]}set g(t){this._values[1]=t}set y(t){this._values[1]=t}get b(){return this._values[2]}get z(){return this._values[2]}set b(t){this._values[2]=t}set z(t){this._values[2]=t}get a(){return this._values[3]}get w(){return this._values[3]}set a(t){this._values[3]=t}set w(t){this._values[3]=t}}e.VecN=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1);e.Edge=class{constructor(t,e,i){this._y_start=Math.ceil(t.ndc.y),this._y_end=Math.ceil(e.ndc.y),this._interpolator=i,this._varyings=new Map,this._varying_names=[...i.varyings.keys()],this._from=t,this._to=e;const n=this._y_start-t.ndc.y;this._x_step=(t.ndc.x-e.ndc.x)/(t.ndc.y-e.ndc.y),this._x=t.ndc.x+n*this._x_step;const r=this._x-t.ndc.x;for(let e=0;e<this._varying_names.length;e++){const o=this._varying_names[e],a=i.varyings.get(o);this._varyings.set(o,{current:s.interpolableAddTimes(s.interpolableAddTimes(i.VAO.varyings.get(o)[t.index],a.x_step,r),a.y_step,n),step:s.interpolableAddTimes(a.y_step,a.x_step,this._x_step)})}}step(){this._x+=this._x_step;for(let t=0;t<this._varying_names.length;t++){const e=this._varying_names[t],i=this._varyings.get(e);i.current=s.interpolableAdd(i.current,i.step)}}get x(){return this._x}get y_start(){return this._y_start}get y_end(){return this._y_end}get from(){return this._from}get to(){return this._to}get varyings(){return this._varyings}get gradient(){return this._interpolator}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(9);e.VaryingInterpolator2=class extends s.VaryingInterpolator{constructor(t,e,i){super(i,t,e),this._inv_dx=1/(e.ndc.x-t.ndc.x),this._inv_dy=1/(e.ndc.y-t.ndc.y),this._computeGradients()}_computeGradients(){for(const t in this._vertices[0].varyings){const e=this._VAO.varyings.get(t),i=e[this._vertices[0].index],s=e[this._vertices[1].index];"number"==typeof i?this._varyings.set(t,this._computeFloatGradient(i,s)):this._varyings.set(t,this._computeVecGradient(i,s))}}_computeFloatGradient(t,e){return{x_step:(e-t)*this._inv_dx,y_step:(e-t)*this._inv_dy}}_computeVecGradient(t,e){return{x_step:e.sub(t).times(this._inv_dx),y_step:e.sub(t).times(this._inv_dy)}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),n=i(9);e.VaryingInterpolator3=class extends n.VaryingInterpolator{constructor(t,e,i,s){super(s,t,e,i),this._inv_dx=1/((e.ndc.x-i.ndc.x)*(t.ndc.y-i.ndc.y)-(t.ndc.x-i.ndc.x)*(e.ndc.y-i.ndc.y)),this._inv_dy=-this._inv_dx,this._computeGradients()}_computeGradients(){const t=this._vertices[0].ndc.w,e=this._vertices[1].ndc.w,i=this._vertices[2].ndc.w;for(const n of this._VAO.varyingNames){const r=this._VAO.varyings.get(n);"__ndc"!==n&&(r[this._vertices[0].index]=s.interpolableTimes(r[this._vertices[0].index],t),r[this._vertices[1].index]=s.interpolableTimes(r[this._vertices[1].index],e),r[this._vertices[2].index]=s.interpolableTimes(r[this._vertices[2].index],i));let o=r[this._vertices[0].index],a=r[this._vertices[1].index],h=r[this._vertices[2].index];"number"==typeof o?this._varyings.set(n,this._computeFloatGradient(o,a,h)):this._varyings.set(n,this._computeVecGradient(o,a,h))}}_computeFloatGradient(t,e,i){return{x_step:(e-i)*(this._vertices[0].ndc.y-this._vertices[2].ndc.y)-(t-i)*(this._vertices[1].ndc.y-this._vertices[2].ndc.y)*this._inv_dx,y_step:(e-i)*(this._vertices[0].ndc.x-this._vertices[2].ndc.x)-(t-i)*(this._vertices[1].ndc.x-this._vertices[2].ndc.x)*this._inv_dy}}_computeVecGradient(t,e,i){const s=this._vertices[0].ndc.y-this._vertices[2].ndc.y,n=this._vertices[1].ndc.y-this._vertices[2].ndc.y,r=e.sub(i),o=t.sub(i),a=r.times(s).sub(o.times(n)).times(this._inv_dx),h=this._vertices[0].ndc.x-this._vertices[2].ndc.x,_=this._vertices[1].ndc.x-this._vertices[2].ndc.x;return{x_step:a,y_step:r.times(h).sub(o.times(_)).times(this._inv_dy)}}}},function(t,e,i){"use strict";var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(o,a)}h((s=s.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const n=i(16),r=i(3),o=i(22),a=i(23),h=i(24),_=i(45),c=i(53);class l{constructor(){this.model_scale=1,this.params={model:"suzanne",material:"red_plastic",texture:"light_wood",z:5,show_texture:!1,rotate:!0,per_frag:!1,angle:0};const t=new o.CanvasRenderingTarget;document.body.appendChild(t.domElement),document.body.style.margin="0",document.body.style.padding="0",t.domElement.style.width="100%",t.domElement.style.height="100%",t.domElement.style.display="block",this.cnv=new r.Context(window.innerWidth,window.innerHeight,t),window.addEventListener("resize",()=>{this.cnv.resize(window.innerWidth,window.innerHeight),this.proj=r.Matrix4.perspective(r.radians(70),this.cnv.width/this.cnv.height,.1,1e3),this.update()}),this.clock=new r.Clock,this.proj=r.Matrix4.perspective(r.radians(70),this.cnv.width/this.cnv.height,.1,1e3);const e=(t,e,i,s,n,o)=>{const a=r.vec3(r.clamp(i.dot(o),0,1)).mul(t),h=n.sub(s).normalize(),_=i.reflect(o),c=r.vec3(Math.pow(Math.max(h.dot(_),0),128*e.shininess)).mul(e.specular);return e.ambient.add(a.add(c))};this.prog={vertex_shader:t=>{t.uniforms.show_texture&&(t.varyings.uv=t.attributes.uv);const i=t.uniforms.model,s=i.transform(r.vec4(t.attributes.normal,0)).normalize(),n=r.vec4(t.position.times(this.model_scale),1),o=r.vec3(i.transform(n));if(this.params.per_frag)t.varyings.world_pos=o,t.varyings.normal=s;else{let i=t.uniforms.material.diffuse;t.uniforms.show_texture&&(i=r.vec3(t.uniforms.tex.at(t.varyings.uv))),t.varyings.gouraud=e(i,t.uniforms.material,t.uniforms.light_dir,o,t.uniforms.view_pos,s)}return t.uniforms.mvp.transform(n)},fragment_shader:(t,i)=>{let s;if(this.params.per_frag){let n=i.material.diffuse;i.show_texture&&(n=r.vec3(i.tex.at(t.uv)));const o=t.normal.normalize();s=e(n,i.material,i.light_dir,t.world_pos,i.view_pos,o)}else s=t.gouraud;return r.vec4(s)}},this.setModel(h.models[this.params.model]).then(()=>s(this,void 0,void 0,function*(){yield this.initUniforms(),this.initGUI(),this.start()}))}initGUI(){const t=new n.GUI;t.add(this.params,"model",Object.keys(h.models)).onChange(t=>s(this,void 0,void 0,function*(){this.stop(),yield this.setModel(h.models[t]),yield this.initUniforms(),this.params.rotate?this.start():this.update()})),t.add(this.params,"material",Object.keys(a.materials)).onChange(t=>{this.VAO.setUniform("material",a.materials[t]),this.update()}),t.add(this.params,"texture",Object.keys(_.textures)).onChange(t=>s(this,void 0,void 0,function*(){this.VAO.setUniform("tex",yield c.TextureLoader.fromFile(_.textures[t])),this.update()})),t.add(this.params,"rotate").onChange(t=>{t?(this.clock.getDelta(),this.start()):this.stop()}),t.add(this.params,"show_texture").onChange(()=>this.update()),t.add(this.params,"per_frag").onChange(()=>this.update()),t.add(this.params,"z",1.5,15,.01).onChange(()=>this.update()),t.add(this.params,"angle",0,2*Math.PI,.01).onChange(()=>this.update())}initUniforms(){return s(this,void 0,void 0,function*(){this.VAO.setUniform("tex",yield c.TextureLoader.fromFile(_.textures[this.params.texture])),this.VAO.setUniform("light_dir",r.vec3(0,.5,-1).normalize()),this.VAO.setUniform("view_pos",r.vec3(0)),this.VAO.setUniform("material",a.materials[this.params.material])})}setModel(t){return s(this,void 0,void 0,function*(){const e=yield c.loadModel(t);this.model_scale=1/Math.max(Math.abs(e.bounding_box.min.x),Math.abs(e.bounding_box.min.y),Math.abs(e.bounding_box.min.z),e.bounding_box.max.x,e.bounding_box.max.y,e.bounding_box.max.z),this.VAO=r.VertexArray.fromModel(e)})}start(){this.update(),this.animation_frame_handle=requestAnimationFrame(()=>this.start())}stop(){void 0!==this.animation_frame_handle&&cancelAnimationFrame(this.animation_frame_handle)}update(){this.cnv.useProgram(this.prog);const t=r.Matrix4.scale(1);this.params.rotate&&(this.params.angle=(this.params.angle+.001*this.clock.getDelta())%(2*Math.PI)),t.translate(r.vec3(0,0,this.params.z)),t.rotateY(this.params.angle),this.VAO.setUniform("model",t),this.VAO.setUniform("mvp",this.proj.mul(t)),this.VAO.setUniform("show_texture",this.params.show_texture),this.cnv.clear(r.colors.black),this.cnv.bindVertexArray(this.VAO),this.cnv.drawElements(r.DrawingMode.TRIANGLES,0,this.VAO.indices.length),this.cnv.clearBuffers()}}e.default=l,new l},function(t,e,i){"use strict";function s(t,e){var i=t.__state.conversionName.toString(),s=Math.round(t.r),n=Math.round(t.g),r=Math.round(t.b),o=t.a,a=Math.round(t.h),h=t.s.toFixed(1),_=t.v.toFixed(1);if(e||"THREE_CHAR_HEX"===i||"SIX_CHAR_HEX"===i){for(var c=t.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===i?"rgb("+s+","+n+","+r+")":"CSS_RGBA"===i?"rgba("+s+","+n+","+r+","+o+")":"HEX"===i?"0x"+t.hex.toString(16):"RGB_ARRAY"===i?"["+s+","+n+","+r+"]":"RGBA_ARRAY"===i?"["+s+","+n+","+r+","+o+"]":"RGB_OBJ"===i?"{r:"+s+",g:"+n+",b:"+r+"}":"RGBA_OBJ"===i?"{r:"+s+",g:"+n+",b:"+r+",a:"+o+"}":"HSV_OBJ"===i?"{h:"+a+",s:"+h+",v:"+_+"}":"HSVA_OBJ"===i?"{h:"+a+",s:"+h+",v:"+_+",a:"+o+"}":"unknown format"}i.r(e),i.d(e,"color",function(){return ht}),i.d(e,"controllers",function(){return _t}),i.d(e,"dom",function(){return ct}),i.d(e,"gui",function(){return lt}),i.d(e,"GUI",function(){return dt});var n=Array.prototype.forEach,r=Array.prototype.slice,o={BREAK:{},extend:function(t){return this.each(r.call(arguments,1),function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(i){this.isUndefined(e[i])||(t[i]=e[i])}.bind(this))},this),t},defaults:function(t){return this.each(r.call(arguments,1),function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(i){this.isUndefined(t[i])&&(t[i]=e[i])}.bind(this))},this),t},compose:function(){var t=r.call(arguments);return function(){for(var e=r.call(arguments),i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},each:function(t,e,i){if(t)if(n&&t.forEach&&t.forEach===n)t.forEach(e,i);else if(t.length===t.length+0){var s,r=void 0;for(r=0,s=t.length;r<s;r++)if(r in t&&e.call(i,t[r],r)===this.BREAK)return}else for(var o in t)if(e.call(i,t[o],o)===this.BREAK)return},defer:function(t){setTimeout(t,0)},debounce:function(t,e,i){var s=void 0;return function(){var n=this,r=arguments;var o=i||!s;clearTimeout(s),s=setTimeout(function(){s=null,i||t.apply(n,r)},e),o&&t.apply(n,r)}},toArray:function(t){return t.toArray?t.toArray():r.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return isNaN(t)}),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}},a=[{litmus:o.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:s},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:s},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:s},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:s}}},{litmus:o.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:o.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:o.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(o.isNumber(t.r)&&o.isNumber(t.g)&&o.isNumber(t.b)&&o.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(o.isNumber(t.r)&&o.isNumber(t.g)&&o.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(o.isNumber(t.h)&&o.isNumber(t.s)&&o.isNumber(t.v)&&o.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(o.isNumber(t.h)&&o.isNumber(t.s)&&o.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}],h=void 0,_=void 0,c=function(){_=!1;var t=arguments.length>1?o.toArray(arguments):arguments[0];return o.each(a,function(e){if(e.litmus(t))return o.each(e.conversions,function(e,i){if(h=e.read(t),!1===_&&!1!==h)return _=h,h.conversionName=i,h.conversion=e,o.BREAK}),o.BREAK}),_},l=void 0,d={hsv_to_rgb:function(t,e,i){var s=Math.floor(t/60)%6,n=t/60-Math.floor(t/60),r=i*(1-e),o=i*(1-n*e),a=i*(1-(1-n)*e),h=[[i,a,r],[o,i,r],[r,i,a],[r,o,i],[a,r,i],[i,r,o]][s];return{r:255*h[0],g:255*h[1],b:255*h[2]}},rgb_to_hsv:function(t,e,i){var s=Math.min(t,e,i),n=Math.max(t,e,i),r=n-s,o=void 0;return 0===n?{h:NaN,s:0,v:0}:(o=t===n?(e-i)/r:e===n?2+(i-t)/r:4+(t-e)/r,(o/=6)<0&&(o+=1),{h:360*o,s:r/n,v:n/255})},rgb_to_hex:function(t,e,i){var s=this.hex_with_component(0,2,t);return s=this.hex_with_component(s,1,e),s=this.hex_with_component(s,0,i)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(t,e,i){return i<<(l=8*e)|t&~(255<<l)}},u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},p=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),f=function t(e,i,s){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,i);if(void 0===n){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,i,s)}if("value"in n)return n.value;var o=n.get;return void 0!==o?o.call(s):void 0},g=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},b=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},v=function(){function t(){if(m(this,t),this.__state=c.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return p(t,[{key:"toString",value:function(){return s(this)}},{key:"toHexString",value:function(){return s(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),t}();function y(t,e,i){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(v.recalculateRGB(this,e,i),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(v.recalculateRGB(this,e,i),this.__state.space="RGB"),this.__state[e]=t}})}function x(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(v.recalculateHSV(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(v.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=t}})}v.recalculateRGB=function(t,e,i){if("HEX"===t.__state.space)t.__state[e]=d.component_from_hex(t.__state.hex,i);else{if("HSV"!==t.__state.space)throw new Error("Corrupted color state");o.extend(t.__state,d.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}},v.recalculateHSV=function(t){var e=d.rgb_to_hsv(t.r,t.g,t.b);o.extend(t.__state,{s:e.s,v:e.v}),o.isNaN(e.h)?o.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h},v.COMPONENTS=["r","g","b","h","s","v","hex","a"],y(v.prototype,"r",2),y(v.prototype,"g",1),y(v.prototype,"b",0),x(v.prototype,"h"),x(v.prototype,"s"),x(v.prototype,"v"),Object.defineProperty(v.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(v.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=d.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}});var w=function(){function t(e,i){m(this,t),this.initialValue=e[i],this.domElement=document.createElement("div"),this.object=e,this.property=i,this.__onChange=void 0,this.__onFinishChange=void 0}return p(t,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),t}(),E={};o.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(t,e){o.each(t,function(t){E[t]=e})});var A=/(\d+(\.\d+)?)px/;function C(t){if("0"===t||o.isUndefined(t))return 0;var e=t.match(A);return o.isNull(e)?0:parseFloat(e[1])}var k={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(t,e,i){var s=i,n=e;o.isUndefined(n)&&(n=!0),o.isUndefined(s)&&(s=!0),t.style.position="absolute",n&&(t.style.left=0,t.style.right=0),s&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,e,i,s){var n=i||{},r=E[e];if(!r)throw new Error("Event type "+e+" not supported.");var a=document.createEvent(r);switch(r){case"MouseEvents":var h=n.x||n.clientX||0,_=n.y||n.clientY||0;a.initMouseEvent(e,n.bubbles||!1,n.cancelable||!0,window,n.clickCount||1,0,0,h,_,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=a.initKeyboardEvent||a.initKeyEvent;o.defaults(n,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(e,n.bubbles||!1,n.cancelable,window,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.keyCode,n.charCode);break;default:a.initEvent(e,n.bubbles||!1,n.cancelable||!0)}o.defaults(a,s),t.dispatchEvent(a)},bind:function(t,e,i,s){var n=s||!1;return t.addEventListener?t.addEventListener(e,i,n):t.attachEvent&&t.attachEvent("on"+e,i),k},unbind:function(t,e,i,s){var n=s||!1;return t.removeEventListener?t.removeEventListener(e,i,n):t.detachEvent&&t.detachEvent("on"+e,i),k},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var i=t.className.split(/ +/);-1===i.indexOf(e)&&(i.push(e),t.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return k},removeClass:function(t,e){if(e)if(t.className===e)t.removeAttribute("class");else{var i=t.className.split(/ +/),s=i.indexOf(e);-1!==s&&(i.splice(s,1),t.className=i.join(" "))}else t.className=void 0;return k},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var e=getComputedStyle(t);return C(e["border-left-width"])+C(e["border-right-width"])+C(e["padding-left"])+C(e["padding-right"])+C(e.width)},getHeight:function(t){var e=getComputedStyle(t);return C(e["border-top-width"])+C(e["border-bottom-width"])+C(e["padding-top"])+C(e["padding-bottom"])+C(e.height)},getOffset:function(t){var e=t,i={left:0,top:0};if(e.offsetParent)do{i.left+=e.offsetLeft,i.top+=e.offsetTop,e=e.offsetParent}while(e);return i},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}},O=function(t){function e(t,i){m(this,e);var s=b(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),n=s;return s.__prev=s.getValue(),s.__checkbox=document.createElement("input"),s.__checkbox.setAttribute("type","checkbox"),k.bind(s.__checkbox,"change",function(){n.setValue(!n.__prev)},!1),s.domElement.appendChild(s.__checkbox),s.updateDisplay(),s}return g(e,w),p(e,[{key:"setValue",value:function(t){var i=f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),i}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(),S=function(t){function e(t,i,s){m(this,e);var n=b(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),r=s,a=n;if(n.__select=document.createElement("select"),o.isArray(r)){var h={};o.each(r,function(t){h[t]=t}),r=h}return o.each(r,function(t,e){var i=document.createElement("option");i.innerHTML=e,i.setAttribute("value",t),a.__select.appendChild(i)}),n.updateDisplay(),k.bind(n.__select,"change",function(){var t=this.options[this.selectedIndex].value;a.setValue(t)}),n.domElement.appendChild(n.__select),n}return g(e,w),p(e,[{key:"setValue",value:function(t){var i=f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),i}},{key:"updateDisplay",value:function(){return k.isActive(this.__select)?this:(this.__select.value=this.getValue(),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(),M=function(t){function e(t,i){m(this,e);var s=b(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),n=s;function r(){n.setValue(n.__input.value)}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),k.bind(s.__input,"keyup",r),k.bind(s.__input,"change",r),k.bind(s.__input,"blur",function(){n.__onFinishChange&&n.__onFinishChange.call(n,n.getValue())}),k.bind(s.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return g(e,w),p(e,[{key:"updateDisplay",value:function(){return k.isActive(this.__input)||(this.__input.value=this.getValue()),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}();function T(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var z=function(t){function e(t,i,s){m(this,e);var n=b(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),r=s||{};return n.__min=r.min,n.__max=r.max,n.__step=r.step,o.isUndefined(n.__step)?0===n.initialValue?n.__impliedStep=1:n.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(n.initialValue))/Math.LN10))/10:n.__impliedStep=n.__step,n.__precision=T(n.__impliedStep),n}return g(e,w),p(e,[{key:"setValue",value:function(t){var i=t;return void 0!==this.__min&&i<this.__min?i=this.__min:void 0!==this.__max&&i>this.__max&&(i=this.__max),void 0!==this.__step&&i%this.__step!=0&&(i=Math.round(i/this.__step)*this.__step),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i)}},{key:"min",value:function(t){return this.__min=t,this}},{key:"max",value:function(t){return this.__max=t,this}},{key:"step",value:function(t){return this.__step=t,this.__impliedStep=t,this.__precision=T(t),this}}]),e}();var V=function(t){function e(t,i,s){m(this,e);var n=b(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,s));n.__truncationSuspended=!1;var r=n,a=void 0;function h(){r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function _(t){var e=a-t.clientY;r.setValue(r.getValue()+e*r.__impliedStep),a=t.clientY}function c(){k.unbind(window,"mousemove",_),k.unbind(window,"mouseup",c),h()}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),k.bind(n.__input,"change",function(){var t=parseFloat(r.__input.value);o.isNaN(t)||r.setValue(t)}),k.bind(n.__input,"blur",function(){h()}),k.bind(n.__input,"mousedown",function(t){k.bind(window,"mousemove",_),k.bind(window,"mouseup",c),a=t.clientY}),k.bind(n.__input,"keydown",function(t){13===t.keyCode&&(r.__truncationSuspended=!0,this.blur(),r.__truncationSuspended=!1,h())}),n.updateDisplay(),n.domElement.appendChild(n.__input),n}return g(e,z),p(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():function(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i}(this.getValue(),this.__precision),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}();function j(t,e,i,s,n){return s+(t-e)/(i-e)*(n-s)}var L=function(t){function e(t,i,s,n,r){m(this,e);var o=b(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,{min:s,max:n,step:r})),a=o;function h(t){t.preventDefault();var e=a.__background.getBoundingClientRect();return a.setValue(j(t.clientX,e.left,e.right,a.__min,a.__max)),!1}function _(){k.unbind(window,"mousemove",h),k.unbind(window,"mouseup",_),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function c(t){var e=t.touches[0].clientX,i=a.__background.getBoundingClientRect();a.setValue(j(e,i.left,i.right,a.__min,a.__max))}function l(){k.unbind(window,"touchmove",c),k.unbind(window,"touchend",l),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}return o.__background=document.createElement("div"),o.__foreground=document.createElement("div"),k.bind(o.__background,"mousedown",function(t){document.activeElement.blur(),k.bind(window,"mousemove",h),k.bind(window,"mouseup",_),h(t)}),k.bind(o.__background,"touchstart",function(t){if(1!==t.touches.length)return;k.bind(window,"touchmove",c),k.bind(window,"touchend",l),c(t)}),k.addClass(o.__background,"slider"),k.addClass(o.__foreground,"slider-fg"),o.updateDisplay(),o.__background.appendChild(o.__foreground),o.domElement.appendChild(o.__background),o}return g(e,z),p(e,[{key:"updateDisplay",value:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(),P=function(t){function e(t,i,s){m(this,e);var n=b(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),r=n;return n.__button=document.createElement("div"),n.__button.innerHTML=void 0===s?"Fire":s,k.bind(n.__button,"click",function(t){return t.preventDefault(),r.fire(),!1}),k.addClass(n.__button,"button"),n.domElement.appendChild(n.__button),n}return g(e,w),p(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(),N=function(t){function e(t,i){m(this,e);var s=b(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));s.__color=new v(s.getValue()),s.__temp=new v(0);var n=s;s.domElement=document.createElement("div"),k.makeSelectable(s.domElement,!1),s.__selector=document.createElement("div"),s.__selector.className="selector",s.__saturation_field=document.createElement("div"),s.__saturation_field.className="saturation-field",s.__field_knob=document.createElement("div"),s.__field_knob.className="field-knob",s.__field_knob_border="2px solid ",s.__hue_knob=document.createElement("div"),s.__hue_knob.className="hue-knob",s.__hue_field=document.createElement("div"),s.__hue_field.className="hue-field",s.__input=document.createElement("input"),s.__input.type="text",s.__input_textShadow="0 1px 1px ",k.bind(s.__input,"keydown",function(t){13===t.keyCode&&d.call(this)}),k.bind(s.__input,"blur",d),k.bind(s.__selector,"mousedown",function(){k.addClass(this,"drag").bind(window,"mouseup",function(){k.removeClass(n.__selector,"drag")})}),k.bind(s.__selector,"touchstart",function(){k.addClass(this,"drag").bind(window,"touchend",function(){k.removeClass(n.__selector,"drag")})});var r=document.createElement("div");function a(t){p(t),k.bind(window,"mousemove",p),k.bind(window,"touchmove",p),k.bind(window,"mouseup",_),k.bind(window,"touchend",_)}function h(t){f(t),k.bind(window,"mousemove",f),k.bind(window,"touchmove",f),k.bind(window,"mouseup",l),k.bind(window,"touchend",l)}function _(){k.unbind(window,"mousemove",p),k.unbind(window,"touchmove",p),k.unbind(window,"mouseup",_),k.unbind(window,"touchend",_),u()}function l(){k.unbind(window,"mousemove",f),k.unbind(window,"touchmove",f),k.unbind(window,"mouseup",l),k.unbind(window,"touchend",l),u()}function d(){var t=c(this.value);!1!==t?(n.__color.__state=t,n.setValue(n.__color.toOriginal())):this.value=n.__color.toString()}function u(){n.__onFinishChange&&n.__onFinishChange.call(n,n.__color.toOriginal())}function p(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=n.__saturation_field.getBoundingClientRect(),i=t.touches&&t.touches[0]||t,s=i.clientX,r=i.clientY,o=(s-e.left)/(e.right-e.left),a=1-(r-e.top)/(e.bottom-e.top);return a>1?a=1:a<0&&(a=0),o>1?o=1:o<0&&(o=0),n.__color.v=a,n.__color.s=o,n.setValue(n.__color.toOriginal()),!1}function f(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=n.__hue_field.getBoundingClientRect(),i=1-((t.touches&&t.touches[0]||t).clientY-e.top)/(e.bottom-e.top);return i>1?i=1:i<0&&(i=0),n.__color.h=360*i,n.setValue(n.__color.toOriginal()),!1}return o.extend(s.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),o.extend(s.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:s.__field_knob_border+(s.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),o.extend(s.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),o.extend(s.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),o.extend(r.style,{width:"100%",height:"100%",background:"none"}),B(r,"top","rgba(0,0,0,0)","#000"),o.extend(s.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),function(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}(s.__hue_field),o.extend(s.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:s.__input_textShadow+"rgba(0,0,0,0.7)"}),k.bind(s.__saturation_field,"mousedown",a),k.bind(s.__saturation_field,"touchstart",a),k.bind(s.__field_knob,"mousedown",a),k.bind(s.__field_knob,"touchstart",a),k.bind(s.__hue_field,"mousedown",h),k.bind(s.__hue_field,"touchstart",h),s.__saturation_field.appendChild(r),s.__selector.appendChild(s.__field_knob),s.__selector.appendChild(s.__saturation_field),s.__selector.appendChild(s.__hue_field),s.__hue_field.appendChild(s.__hue_knob),s.domElement.appendChild(s.__input),s.domElement.appendChild(s.__selector),s.updateDisplay(),s}return g(e,w),p(e,[{key:"updateDisplay",value:function(){var t=c(this.getValue());if(!1!==t){var e=!1;o.each(v.COMPONENTS,function(i){if(!o.isUndefined(t[i])&&!o.isUndefined(this.__color.__state[i])&&t[i]!==this.__color.__state[i])return e=!0,{}},this),e&&o.extend(this.__color.__state,t)}o.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var i=this.__color.v<.5||this.__color.s>.5?255:0,s=255-i;o.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+i+","+i+","+i+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,B(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),o.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+i+","+i+","+i+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}}]),e}(),R=["-moz-","-o-","-webkit-","-ms-",""];function B(t,e,i,s){t.style.background="",o.each(R,function(n){t.style.cssText+="background: "+n+"linear-gradient("+e+", "+i+" 0%, "+s+" 100%); "})}var F=function(t,e){var i=e||document,s=document.createElement("style");s.type="text/css",s.innerHTML=t;var n=i.getElementsByTagName("head")[0];try{n.appendChild(s)}catch(t){}},I=function(t,e){var i=t[e];return o.isArray(arguments[2])||o.isObject(arguments[2])?new S(t,e,arguments[2]):o.isNumber(i)?o.isNumber(arguments[2])&&o.isNumber(arguments[3])?o.isNumber(arguments[4])?new L(t,e,arguments[2],arguments[3],arguments[4]):new L(t,e,arguments[2],arguments[3]):o.isNumber(arguments[4])?new V(t,e,{min:arguments[2],max:arguments[3],step:arguments[4]}):new V(t,e,{min:arguments[2],max:arguments[3]}):o.isString(i)?new M(t,e):o.isFunction(i)?new P(t,e,""):o.isBoolean(i)?new O(t,e):null};var D=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)},H=function(){function t(){m(this,t),this.backgroundElement=document.createElement("div"),o.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),k.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),o.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;k.bind(this.backgroundElement,"click",function(){e.hide()})}return p(t,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),o.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,e=function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",k.unbind(t.domElement,"webkitTransitionEnd",e),k.unbind(t.domElement,"transitionend",e),k.unbind(t.domElement,"oTransitionEnd",e)};k.bind(this.domElement,"webkitTransitionEnd",e),k.bind(this.domElement,"transitionend",e),k.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-k.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-k.getHeight(this.domElement)/2+"px"}}]),t}();F(function(t){if(t&&"undefined"!=typeof window){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t,document.head.appendChild(e),t}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var U="Default",G=function(){try{return!!window.localStorage}catch(t){return!1}}(),X=void 0,Y=!0,W=void 0,J=!1,K=[],q=function t(e){var i=this,s=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),k.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],s=o.defaults(s,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),s=o.defaults(s,{resizable:s.autoPlace,hideable:s.autoPlace}),o.isUndefined(s.load)?s.load={preset:U}:s.preset&&(s.load.preset=s.preset),o.isUndefined(s.parent)&&s.hideable&&K.push(this),s.resizable=o.isUndefined(s.parent)&&s.resizable,s.autoPlace&&o.isUndefined(s.scrollable)&&(s.scrollable=!0);var n=G&&"true"===localStorage.getItem(it(this,"isLocal")),r=void 0,a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return s.parent}},scrollable:{get:function(){return s.scrollable}},autoPlace:{get:function(){return s.autoPlace}},closeOnTop:{get:function(){return s.closeOnTop}},preset:{get:function(){return i.parent?i.getRoot().preset:s.load.preset},set:function(t){i.parent?i.getRoot().preset=t:s.load.preset=t,function(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}(this),i.revert()}},width:{get:function(){return s.width},set:function(t){s.width=t,ot(i,t)}},name:{get:function(){return s.name},set:function(t){s.name=t,a&&(a.innerHTML=s.name)}},closed:{get:function(){return s.closed},set:function(e){s.closed=e,s.closed?k.addClass(i.__ul,t.CLASS_CLOSED):k.removeClass(i.__ul,t.CLASS_CLOSED),this.onResize(),i.__closeButton&&(i.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return s.load}},useLocalStorage:{get:function(){return n},set:function(t){G&&(n=t,t?k.bind(window,"unload",r):k.unbind(window,"unload",r),localStorage.setItem(it(i,"isLocal"),t))}}}),o.isUndefined(s.parent)){if(s.closed=!1,k.addClass(this.domElement,t.CLASS_MAIN),k.makeSelectable(this.domElement,!1),G&&n){i.useLocalStorage=!0;var h=localStorage.getItem(it(this,"gui"));h&&(s.load=JSON.parse(h))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,k.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),s.closeOnTop?(k.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(k.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),k.bind(this.__closeButton,"click",function(){i.closed=!i.closed})}else{void 0===s.closed&&(s.closed=!0);var _=document.createTextNode(s.name);k.addClass(_,"controller-name"),a=Q(i,_);k.addClass(this.__ul,t.CLASS_CLOSED),k.addClass(a,"title"),k.bind(a,"click",function(t){return t.preventDefault(),i.closed=!i.closed,!1}),s.closed||(this.closed=!1)}s.autoPlace&&(o.isUndefined(s.parent)&&(Y&&(W=document.createElement("div"),k.addClass(W,"dg"),k.addClass(W,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(W),Y=!1),W.appendChild(this.domElement),k.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||ot(i,s.width)),this.__resizeHandler=function(){i.onResizeDebounced()},k.bind(window,"resize",this.__resizeHandler),k.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),k.bind(this.__ul,"transitionend",this.__resizeHandler),k.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),s.resizable&&rt(this),r=function(){G&&"true"===localStorage.getItem(it(i,"isLocal"))&&localStorage.setItem(it(i,"gui"),JSON.stringify(i.getSaveObject()))},this.saveToLocalStorageIfPossible=r,s.parent||function(){var t=i.getRoot();t.width+=1,o.defer(function(){t.width-=1})}()};function Q(t,e,i){var s=document.createElement("li");return e&&s.appendChild(e),i?t.__ul.insertBefore(s,i):t.__ul.appendChild(s),t.onResize(),s}function $(t){k.unbind(window,"resize",t.__resizeHandler),t.saveToLocalStorageIfPossible&&k.unbind(window,"unload",t.saveToLocalStorageIfPossible)}function Z(t,e){var i=t.__preset_select[t.__preset_select.selectedIndex];i.innerHTML=e?i.value+"*":i.value}function tt(t,e){var i=t.getRoot(),s=i.__rememberedObjects.indexOf(e.object);if(-1!==s){var n=i.__rememberedObjectIndecesToControllers[s];if(void 0===n&&(n={},i.__rememberedObjectIndecesToControllers[s]=n),n[e.property]=e,i.load&&i.load.remembered){var r=i.load.remembered,o=void 0;if(r[t.preset])o=r[t.preset];else{if(!r[U])return;o=r[U]}if(o[s]&&void 0!==o[s][e.property]){var a=o[s][e.property];e.initialValue=a,e.setValue(a)}}}}function et(t,e,i,s){if(void 0===e[i])throw new Error('Object "'+e+'" has no property "'+i+'"');var n=void 0;if(s.color)n=new N(e,i);else{var r=[e,i].concat(s.factoryArgs);n=I.apply(t,r)}s.before instanceof w&&(s.before=s.before.__li),tt(t,n),k.addClass(n.domElement,"c");var a=document.createElement("span");k.addClass(a,"property-name"),a.innerHTML=n.property;var h=document.createElement("div");h.appendChild(a),h.appendChild(n.domElement);var _=Q(t,h,s.before);return k.addClass(_,q.CLASS_CONTROLLER_ROW),n instanceof N?k.addClass(_,"color"):k.addClass(_,u(n.getValue())),function(t,e,i){if(i.__li=e,i.__gui=t,o.extend(i,{options:function(e){if(arguments.length>1){var s=i.__li.nextElementSibling;return i.remove(),et(t,i.object,i.property,{before:s,factoryArgs:[o.toArray(arguments)]})}if(o.isArray(e)||o.isObject(e)){var n=i.__li.nextElementSibling;return i.remove(),et(t,i.object,i.property,{before:n,factoryArgs:[e]})}},name:function(t){return i.__li.firstElementChild.firstElementChild.innerHTML=t,i},listen:function(){return i.__gui.listen(i),i},remove:function(){return i.__gui.remove(i),i}}),i instanceof L){var s=new V(i.object,i.property,{min:i.__min,max:i.__max,step:i.__step});o.each(["updateDisplay","onChange","onFinishChange","step"],function(t){var e=i[t],n=s[t];i[t]=s[t]=function(){var t=Array.prototype.slice.call(arguments);return n.apply(s,t),e.apply(i,t)}}),k.addClass(e,"has-slider"),i.domElement.insertBefore(s.domElement,i.domElement.firstElementChild)}else if(i instanceof V){var n=function(e){if(o.isNumber(i.__min)&&o.isNumber(i.__max)){var s=i.__li.firstElementChild.firstElementChild.innerHTML,n=i.__gui.__listening.indexOf(i)>-1;i.remove();var r=et(t,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[i.__min,i.__max,i.__step]});return r.name(s),n&&r.listen(),r}return e};i.min=o.compose(n,i.min),i.max=o.compose(n,i.max)}else i instanceof O?(k.bind(e,"click",function(){k.fakeEvent(i.__checkbox,"click")}),k.bind(i.__checkbox,"click",function(t){t.stopPropagation()})):i instanceof P?(k.bind(e,"click",function(){k.fakeEvent(i.__button,"click")}),k.bind(e,"mouseover",function(){k.addClass(i.__button,"hover")}),k.bind(e,"mouseout",function(){k.removeClass(i.__button,"hover")})):i instanceof N&&(k.addClass(e,"color"),i.updateDisplay=o.compose(function(t){return e.style.borderLeftColor=i.__color.toString(),t},i.updateDisplay),i.updateDisplay());i.setValue=o.compose(function(e){return t.getRoot().__preset_select&&i.isModified()&&Z(t.getRoot(),!0),e},i.setValue)}(t,_,n),t.__controllers.push(n),n}function it(t,e){return document.location.href+"."+e}function st(t,e,i){var s=document.createElement("option");s.innerHTML=e,s.value=e,t.__preset_select.appendChild(s),i&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function nt(t,e){e.style.display=t.useLocalStorage?"block":"none"}function rt(t){var e=void 0;function i(i){return i.preventDefault(),t.width+=e-i.clientX,t.onResize(),e=i.clientX,!1}function s(){k.removeClass(t.__closeButton,q.CLASS_DRAG),k.unbind(window,"mousemove",i),k.unbind(window,"mouseup",s)}function n(n){return n.preventDefault(),e=n.clientX,k.addClass(t.__closeButton,q.CLASS_DRAG),k.bind(window,"mousemove",i),k.bind(window,"mouseup",s),!1}t.__resize_handle=document.createElement("div"),o.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),k.bind(t.__resize_handle,"mousedown",n),k.bind(t.__closeButton,"mousedown",n),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function ot(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function at(t,e){var i={};return o.each(t.__rememberedObjects,function(s,n){var r={},a=t.__rememberedObjectIndecesToControllers[n];o.each(a,function(t,i){r[i]=e?t.initialValue:t.getValue()}),i[n]=r}),i}q.toggleHide=function(){J=!J,o.each(K,function(t){t.domElement.style.display=J?"none":""})},q.CLASS_AUTO_PLACE="a",q.CLASS_AUTO_PLACE_CONTAINER="ac",q.CLASS_MAIN="main",q.CLASS_CONTROLLER_ROW="cr",q.CLASS_TOO_TALL="taller-than-window",q.CLASS_CLOSED="closed",q.CLASS_CLOSE_BUTTON="close-button",q.CLASS_CLOSE_TOP="close-top",q.CLASS_CLOSE_BOTTOM="close-bottom",q.CLASS_DRAG="drag",q.DEFAULT_WIDTH=245,q.TEXT_CLOSED="Close Controls",q.TEXT_OPEN="Open Controls",q._keydownHandler=function(t){"text"===document.activeElement.type||72!==t.which&&72!==t.keyCode||q.toggleHide()},k.bind(window,"keydown",q._keydownHandler,!1),o.extend(q.prototype,{add:function(t,e){return et(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return et(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;o.defer(function(){e.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&W.removeChild(this.domElement);var t=this;o.each(this.__folders,function(e){t.removeFolder(e)}),k.unbind(window,"keydown",q._keydownHandler,!1),$(this)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var i=new q(e);this.__folders[t]=i;var s=Q(this,i.domElement);return k.addClass(s,"folder"),i},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],$(t);var e=this;o.each(t.__folders,function(e){t.removeFolder(e)}),o.defer(function(){e.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=k.getOffset(t.__ul).top,i=0;o.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(i+=k.getHeight(e))}),window.innerHeight-e-20<i?(k.addClass(t.domElement,q.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):(k.removeClass(t.domElement,q.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&o.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},onResizeDebounced:o.debounce(function(){this.onResize()},50),remember:function(){if(o.isUndefined(X)&&((X=new H).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;o.each(Array.prototype.slice.call(arguments),function(e){0===t.__rememberedObjects.length&&function(t){var e=t.__save_row=document.createElement("li");k.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),k.addClass(e,"save-row");var i=document.createElement("span");i.innerHTML="&nbsp;",k.addClass(i,"button gears");var s=document.createElement("span");s.innerHTML="Save",k.addClass(s,"button"),k.addClass(s,"save");var n=document.createElement("span");n.innerHTML="New",k.addClass(n,"button"),k.addClass(n,"save-as");var r=document.createElement("span");r.innerHTML="Revert",k.addClass(r,"button"),k.addClass(r,"revert");var a=t.__preset_select=document.createElement("select");t.load&&t.load.remembered?o.each(t.load.remembered,function(e,i){st(t,i,i===t.preset)}):st(t,U,!1);if(k.bind(a,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),e.appendChild(a),e.appendChild(i),e.appendChild(s),e.appendChild(n),e.appendChild(r),G){var h=document.getElementById("dg-local-explain"),_=document.getElementById("dg-local-storage"),c=document.getElementById("dg-save-locally");c.style.display="block","true"===localStorage.getItem(it(t,"isLocal"))&&_.setAttribute("checked","checked"),nt(t,h),k.bind(_,"change",function(){t.useLocalStorage=!t.useLocalStorage,nt(t,h)})}var l=document.getElementById("dg-new-constructor");k.bind(l,"keydown",function(t){!t.metaKey||67!==t.which&&67!==t.keyCode||X.hide()}),k.bind(i,"click",function(){l.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),X.show(),l.focus(),l.select()}),k.bind(s,"click",function(){t.save()}),k.bind(n,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),k.bind(r,"click",function(){t.revert()})}(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&ot(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=at(this)),t.folders={},o.each(this.__folders,function(e,i){t.folders[i]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=at(this),Z(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[U]=at(this,!0)),this.load.remembered[t]=at(this),this.preset=t,st(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){o.each(this.__controllers,function(e){this.getRoot().load.remembered?tt(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())},this),o.each(this.__folders,function(t){t.revert(t)}),t||Z(this.getRoot(),!1)},listen:function(t){var e=0===this.__listening.length;this.__listening.push(t),e&&function t(e){0!==e.length&&D.call(window,function(){t(e)});o.each(e,function(t){t.updateDisplay()})}(this.__listening)},updateDisplay:function(){o.each(this.__controllers,function(t){t.updateDisplay()}),o.each(this.__folders,function(t){t.updateDisplay()})}});var ht={Color:v,math:d,interpret:c},_t={Controller:w,BooleanController:O,OptionController:S,StringController:M,NumberController:z,NumberControllerBox:V,NumberControllerSlider:L,FunctionController:P,ColorController:N},ct={dom:k},lt={GUI:q},dt=q,ut={color:ht,controllers:_t,dom:ct,gui:lt,GUI:dt};e.default=ut},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(4),n=i(12),r=i(1),o=i(8),a=i(0),h=i(13),_=i(14);var c;!function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.TRIANGLES=2]="TRIANGLES"}(c=e.DrawingMode||(e.DrawingMode={}));e.Context=class extends s.Bitmap{constructor(t,e,i,s){super(t,e),this._target=i,this._initOptions(s),this._screen_space_matrix=o.Matrix4.screenSpace(t,e)}initDepthBuffer(){this._options.depth_test&&(this._depth_buffer=new Float32Array(this._width*this._height),this._depth_buffer.fill(1/0))}_initOptions(t={}){this._options=Object.assign({depth_test:!0,backface_culling:!0},t),void 0!==this._target.init&&this._target.init(this._width,this._height),this.initDepthBuffer()}_perspectiveTransform(t){const e=this._program.vertex_shader(t),i=this._screen_space_matrix.transform(e),s=new a.Vec4(i.x/i.w,i.y/i.w,i.z/i.w,1/i.w);return t.varyings.__ndc=s,{ndc:s,varyings:t.varyings,index:t.index}}_shouldDrawFragment(t,e,i){if(this._options.depth_test){const s=t+e*this._width;if(i>this._depth_buffer[s])return!1;this._depth_buffer[s]=i}return!0}_scanLine(t,e,i){t=Math.ceil(t);const s=Math.ceil(e.x),n=Math.ceil(i.x),o=s-e.x;this._initVaryings(e,o),this._current_varyings={};const a=this._current_gradient.varyings.get("__ndc");let h;for(let e=s;e<n;e++){this._current_gradient.stepX(a),h=1/a.current.w;for(const t of this._vertex_array.varyingNames){if("__ndc"===t)continue;const e=this._current_gradient.varyings.get(t);this._current_varyings[t]=r.interpolableTimes(this._current_gradient.stepX(e),h)}this._shouldDrawFragment(e,t,a.current.z)&&this._set(e,t,this._program.fragment_shader(this._current_varyings,this._vertex_array.uniforms))}}_initVaryings(t,e){for(const i of this._vertex_array.varyingNames){const s=this._current_gradient.varyings.get(i);s.current=r.interpolableAdd(t.varyings.get(i).current,r.interpolableTimes(s.x_step,e))}}_strokeEdge(t){const e=t.from,i=t.to,s=Math.ceil(e.ndc.x),n=Math.ceil(e.ndc.y),r=Math.ceil(i.ndc.x),o=Math.ceil(i.ndc.y),a=Math.abs(r-s),h=Math.abs(o-n),_=s<r?1:-1,c=n<o?1:-1;let l=a-h;this._current_gradient=t.gradient;const d=s-e.ndc.x;this._initVaryings(t,d);let u=s,m=n;const p={};for(;u!==r||m!==o;){for(const[t,e]of this._current_gradient.varyings)this._current_gradient.stepX(e),p[t]=e.current;const t=2*l;t>-h&&(l-=h,u+=_),t<a&&(l+=a,m+=c)}}_drawLines(t,e){for(let i=t;i<t+e;i+=2){const t=this._perspectiveTransform(this._vertex_array.at(i)),e=this._perspectiveTransform(this._vertex_array.at(i+1));this._strokeEdge(new n.Edge(t,e,new h.VaryingInterpolator2(t,e,this._vertex_array)))}}_drawLinesIndexed(t,e){const i=this._vertex_array.indices;for(let s=t;s<t+e;s+=2){const t=this._perspectiveTransform(this._vertex_array.at(i[s])),e=this._perspectiveTransform(this._vertex_array.at(i[s+1]));this._strokeEdge(new n.Edge(t,e,new h.VaryingInterpolator2(t,e,this._vertex_array)))}}_drawTriangles(t,e,i){for(let s=t;s<t+e;s+=3){const t=this._perspectiveTransform(this._vertex_array.at(s)),e=this._perspectiveTransform(this._vertex_array.at(s+1)),n=this._perspectiveTransform(this._vertex_array.at(s+2));i?this._strokeTriangle(t,e,n):this._fillTriangle(t,e,n)}}_drawTrianglesIndexed(t,e,i){const s=this._vertex_array.indices;for(let n=t+e-1;n>=0;n-=3){const t=this._perspectiveTransform(this._vertex_array.at(s[n-2])),e=this._perspectiveTransform(this._vertex_array.at(s[n-1])),r=this._perspectiveTransform(this._vertex_array.at(s[n]));i?this._strokeTriangle(t,e,r):this._fillTriangle(t,e,r)}}_strokeTriangle(t,e,i){this._strokeEdge(new n.Edge(t,e,new h.VaryingInterpolator2(t,e,this._vertex_array))),this._strokeEdge(new n.Edge(t,i,new h.VaryingInterpolator2(t,i,this._vertex_array))),this._strokeEdge(new n.Edge(e,i,new h.VaryingInterpolator2(e,i,this._vertex_array)))}_fillTriangle(t,e,i){if(this._options.backface_culling&&r.parallelogramArea(t.ndc,e.ndc,i.ndc)<0)return;let s=!1;i.ndc.y<e.ndc.y&&([i,e]=[e,i],s=!s),e.ndc.y<t.ndc.y&&([e,t]=[t,e],s=!s),i.ndc.y<e.ndc.y&&([i,e]=[e,i],s=!s);const o=new _.VaryingInterpolator3(t,e,i,this._vertex_array);this._current_gradient=o;const a=new n.Edge(t,i,o);this._scanEdges(a,new n.Edge(t,e,o),s),this._scanEdges(a,new n.Edge(e,i,o),s)}_scanEdges(t,e,i){let s=t,n=e;const r=e.y_start,o=e.y_end;i&&([s,n]=[n,s]);for(let t=r;t<o;t++)this._scanLine(t,s,n),s.step(),n.step()}drawArrays(t,e,i,s=!1){switch(t){case c.LINES:this._drawLines(e,i);break;case c.TRIANGLES:this._drawTriangles(e,i,s);break;default:throw new Error(`Drawing mode ${t} not implemented yet`)}this.draw()}drawElements(t,e,i,s=!1){if(!this._vertex_array.indexed)throw new Error("Cannot draw elements: indices not defined in bound vertex array");switch(t){case c.LINES:this._drawLinesIndexed(e,i);break;case c.TRIANGLES:this._drawTrianglesIndexed(e,i,s);break;default:throw new Error(`Drawing mode ${t} not implemented yet`)}this.draw()}useProgram(t){this._program=t}bindVertexArray(t){this._vertex_array=t}_clearDepthBuffer(){this._options.depth_test&&this._depth_buffer.fill(1/0)}clearBuffers(){this._clearDepthBuffer()}draw(){this._target.draw(this)}get options(){return this._options}resize(t,e){super.resize(t,e),this.initDepthBuffer(),this._screen_space_matrix=o.Matrix4.screenSpace(t,e),void 0!==this._target.resize&&this._target.resize(t,e)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Clock=class{constructor(){this.last_tick=Date.now()}getDelta(){const t=Date.now(),e=t-this.last_tick;return this.last_tick=t,e}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(6),n=i(7),r=i(5);!function(t){const e=t=>{const e=t.substr(2).split(" ").map(t=>parseFloat(t));return new n.Vec3(e[0],1-e[1],e[2])},i=t=>{const e=t.substr(3).split(" ").map(t=>parseFloat(t));return new s.Vec2(e[0],e[1])},o=t=>{const e=t.substr(3).split(" ").map(t=>parseFloat(t));return new n.Vec3(e[0],e[1],e[2])};t.parseOBJ=(t=>{const s=t.split("\n"),n=[],a=[],h=[],_=[],c=new Map;let l=0;const d={vertices:[],indices:null,attributes:{uv:[],normal:[]},bounding_box:{min:r.vec3(1/0),max:r.vec3(0)}};for(let t of s)switch((t=t.trim()).charAt(0)){case"v":switch(t.charAt(1)){case" ":const s=e(t);s.x>d.bounding_box.max.x&&(d.bounding_box.max.x=s.x),s.y>d.bounding_box.max.y&&(d.bounding_box.max.y=s.y),s.z>d.bounding_box.max.z&&(d.bounding_box.max.z=s.z),s.x<d.bounding_box.min.x&&(d.bounding_box.min.x=s.x),s.y<d.bounding_box.min.y&&(d.bounding_box.min.y=s.y),s.z<d.bounding_box.min.z&&(d.bounding_box.min.z=s.z),n.push(s);break;case"t":a.push(i(t));break;case"n":h.push(o(t))}break;case"f":const s=t.substr(2).split(" ");let r=[];for(const t of s){if(c.has(t)){r.push(c.get(t));continue}const[e,i,s]=t.split("/").map(t=>parseInt(t)-1);d.vertices.push(n[e]),void 0!==i&&d.attributes.uv.push(a[i]),void 0!==s&&d.attributes.normal.push(h[s]),c.set(t,l),r.push(l),l++}if(4===s.length){const t=r[3];r[3]=r[2],r[4]=t,r[5]=r[0]}_.push(...r)}return d.indices=l<256?new Uint8Array(_):l<65536?new Uint16Array(_):new Uint32Array(_),d})}(e.ModelLoader||(e.ModelLoader={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(4);e.Texture=class extends s.Bitmap{constructor(t,e){super(t,e)}at(t){return super.read(Math.floor(t.x*this._width),Math.floor(t.y*this._height))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t){this._vertices=t,this._attributes=new Map,this._varyings=new Map,this._varying_names=[],this._uniforms={},this._current_idx=0,this._attribute_accessor=new Proxy({},{get:(t,e)=>{if("string"==typeof e&&"inspect"!==e){if(this._attributes.has(e))return this._attributes.get(e)[this._current_idx];throw new Error(`Undefined attribute: ${e}`)}}}),this._varying_setter=new Proxy({},{set:(t,e,i)=>{const s=this._varyings.get(e);if(void 0===s){const t=[];t[this._current_idx]=i,this._varyings.set(e,t),this._varying_names.push(e)}else s[this._current_idx]=i;return t[e]=i,!0}})}at(t){return this._current_idx=t,{position:this._vertices[t],attributes:this._attribute_accessor,uniforms:this._uniforms,varyings:this._varying_setter,index:t}}addAttribute(t,e){if(e.length<this._vertices.length)throw new Error(`Not enough data for attribute ${t}`);this._attributes.set(t,e)}setUniform(t,e){this._uniforms[t]=e}indexed(){return void 0!==this._indices}get indices(){return this._indices}set indices(t){this._indices=t}get varyings(){return this._varyings}get varyingNames(){return this._varying_names}get uniforms(){return this._uniforms}static fromModel(t){const e=new s(t.vertices);void 0!==t.indices&&(e.indices=t.indices);for(const i in t.attributes){const s=t.attributes[i];void 0!==s&&e.addAttribute(i,s)}return e}get vertexCount(){return this._vertices.length}}e.VertexArray=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.CanvasRenderingTarget=class{constructor(){this._ctx=document.createElement("canvas").getContext("2d")}init(t,e){this.resize(t,e)}resize(t,e){this._ctx.canvas.width=t,this._ctx.canvas.height=e,this._img=new ImageData(t,e)}draw(t){if(t.width!==this._ctx.canvas.width||t.height!==this._ctx.canvas.height)throw new Error(`Cannot draw a ${t.width} by ${t.height} bitmap`+`on a ${this._ctx.canvas.width} by ${this._ctx.canvas.height} canvas, `+"consider resize the CanvasRenderingTarget before drawing");this._img.data.set(t.data),this._ctx.putImageData(this._img,0,0)}get domElement(){return this._ctx.canvas}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(3);e.materials={emerald:{ambient:s.vec3(.0215,.1745,.0215),diffuse:s.vec3(.07568,.61424,.07568),specular:s.vec3(.633,.727811,.633),shininess:.6},red_plastic:{ambient:s.vec3(0),diffuse:s.vec3(.5,0,0),specular:s.vec3(.7,.6,.6),shininess:.25},ruby:{ambient:s.vec3(.1745,.01175,.01175),diffuse:s.vec3(.61424,.04136,.04136),specular:s.vec3(.727811,.626959,.626959),shininess:.6},gold:{ambient:s.vec3(.24725,.1995,.0745),diffuse:s.vec3(.75164,.60648,.22648),specular:s.vec3(.628281,.555802,.366065),shininess:.4},obsidian:{ambient:s.vec3(.05375,.05,.06625),diffuse:s.vec3(.18275,.17,.22525),specular:s.vec3(.332741,.328634,.346435),shininess:.3},shiny_wood:{ambient:s.vec3(.2),diffuse:s.vec3(1),specular:s.vec3(.3),shininess:.4},green_rubber:{ambient:s.vec3(0,.05,0),diffuse:s.vec3(.4,.5,.4),specular:s.vec3(.04,.7,.04),shininess:.078125},chrome:{ambient:s.vec3(.25,.25,.25),diffuse:s.vec3(.4,.4,.4),specular:s.vec3(.774597,.774597,.774597),shininess:.6},copper:{ambient:s.vec3(.19125,.0735,.0225),diffuse:s.vec3(.7038,.27048,.0828),specular:s.vec3(.256777,.137622,.086014),shininess:.1},bronze:{ambient:s.vec3(.2125,.1275,.054),diffuse:s.vec3(.714,.4284,.18144),specular:s.vec3(.393548,.271906,.166721),shininess:.2}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.models={icosphere:i(25),icosphere_smooth:i(26),uvsphere:i(27),uvsphere_smooth:i(28),cube:i(29),torus:i(30),monkey:i(31),suzanne:i(32),suzanne_smooth:i(33),suzanne_smoother:i(34),suzanne_smoothest:i(35),bunny:i(36),cruiser:i(37),toyplane:i(38),teapot:i(39),tea_spoon:i(40),menger_sponge:i(41),gear:i(42),wall:i(43),triangle:i(44)}},function(t,e,i){t.exports=i.p+"res/models/icosphere.obj"},function(t,e,i){t.exports=i.p+"res/models/icosphere_smooth.obj"},function(t,e,i){t.exports=i.p+"res/models/uvsphere.obj"},function(t,e,i){t.exports=i.p+"res/models/uvsphere_smooth.obj"},function(t,e,i){t.exports=i.p+"res/models/cube.obj"},function(t,e,i){t.exports=i.p+"res/models/torus.obj"},function(t,e,i){t.exports=i.p+"res/models/monkey.obj"},function(t,e,i){t.exports=i.p+"res/models/suzanne.obj"},function(t,e,i){t.exports=i.p+"res/models/suzanne_smooth.obj"},function(t,e,i){t.exports=i.p+"res/models/suzanne_smoother.obj"},function(t,e,i){t.exports=i.p+"res/models/suzanne_smoothest.obj"},function(t,e,i){t.exports=i.p+"res/models/bunny.obj"},function(t,e,i){t.exports=i.p+"res/models/cruiser.obj"},function(t,e,i){t.exports=i.p+"res/models/toyplane.obj"},function(t,e,i){t.exports=i.p+"res/models/teapot.obj"},function(t,e,i){t.exports=i.p+"res/models/tea_spoon.obj"},function(t,e,i){t.exports=i.p+"res/models/menger_sponge.obj"},function(t,e,i){t.exports=i.p+"res/models/gear.obj"},function(t,e,i){t.exports=i.p+"res/models/wall.obj"},function(t,e,i){t.exports=i.p+"res/models/triangle.obj"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.textures={bricks:i(46),light_wood:i(47),dark_wood:i(48),marble:i(49),fur:i(50),fabric:i(51),cruiser:i(52)}},function(t,e,i){t.exports=i.p+"res/textures/bricks.jpg"},function(t,e,i){t.exports=i.p+"res/textures/wood.jpg"},function(t,e,i){t.exports=i.p+"res/textures/dark_wood.jpg"},function(t,e,i){t.exports=i.p+"res/textures/marble.jpg"},function(t,e,i){t.exports=i.p+"res/textures/fur.jpg"},function(t,e,i){t.exports=i.p+"res/textures/fabric.jpg"},function(t,e,i){t.exports=i.p+"res/textures/cruiser.bmp"},function(t,e,i){"use strict";var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(o,a)}h((s=s.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const n=i(3);e.loadModel=function(t){return s(this,void 0,void 0,function*(){return new Promise((e,i)=>s(this,void 0,void 0,function*(){try{const s=yield(yield fetch(t)).text();e(yield n.ModelLoader.parseOBJ(s))}catch(t){i(t)}}))})},function(t){function e(t){const e=new n.Texture(t.width,t.height);return e.data.set(t.data),e}function i(t){const i=document.createElement("canvas").getContext("2d");return i.canvas.width=t.width,i.canvas.height=t.height,i.drawImage(t,0,0),e(i.getImageData(0,0,t.width,t.height))}t.fromImageData=e,t.fromImage=i,t.fromFile=function(t){return new Promise((e,s)=>{const n=new Image;n.onload=(()=>{e(i(n))}),n.onerror=(()=>{s(t)}),n.src=t})}}(e.TextureLoader||(e.TextureLoader={}))}]);